# Pre-packaged CLIWrappers

As a convenience, some pre-configured wrappers for common tools are included in the package. At the moment, none of
them are well tested, but they are complete in terms of commands and flags. They are generated by the help_parser tool
in this repo.

## Usage

```python
from cli_wrapper.pre_packaged import get_wrapper

kubectl = get_wrapper("kubectl")
helm = get_wrapper("helm")
```

## Available Wrappers

- `kubectl`
- `helm`
- `cilium`
- `docker`
- `terraform`

## Help Parser and Why These Aren't Well Tested

The help parser works by calling the tool with --help, parsing the output, and then calling the tool with `command --help`
help. The help parser takes some semi-obscure command line arguments, like default parsers:

```shell
PYTHONPATH=src python -m help_parser helm --parser-default-pairs json:output=json
```

This will add `--output json` as a default flag and the json parser to every command that seems to support the 
`--output` flag. And this usually works, except for fun cases like this one:

```
> kubectl config get-contexts --help
Display one or many contexts from the kubeconfig file.

Examples:
  # List all the contexts in your kubeconfig file
  kubectl config get-contexts
  
  # Describe one context in your kubeconfig file
  kubectl config get-contexts my-context

Options:
    --no-headers=false:
        When using the default or custom-column output format, don't print headers (default print headers).

    -o, --output='':
        Output format. One of: (name).

Usage:
  kubectl config get-contexts [(-o|--output=)name)] [options]

Use "kubectl options" for a list of global command-line options (applies to all commands).
```

If you want to use the help parser yourself:

```
PYTHONPATH=src python -m help_parser --help
usage: __main__.py [-h] [--help-flag HELP_FLAG] [--style {golang,argparse}] [--default-flags DEFAULT_FLAGS [DEFAULT_FLAGS ...]] [--parser-default-pairs PARSER_DEFAULT_PAIRS [PARSER_DEFAULT_PAIRS ...]] [--default-separator DEFAULT_SEPARATOR] [--long-prefix LONG_PREFIX] [--output OUTPUT] command

Parse CLI command help.

positional arguments:
  command               The CLI command to parse.

options:
  -h, --help            show this help message and exit
  --help-flag HELP_FLAG
                        The flag to use for getting help (default: 'help').
  --style {golang,argparse}
                        The style of cli help output (default: 'golang').
  --default-flags DEFAULT_FLAGS [DEFAULT_FLAGS ...]
                        Default flags to add to the command, key=value pairs.
  --parser-default-pairs PARSER_DEFAULT_PAIRS [PARSER_DEFAULT_PAIRS ...]
                        parser:key=value,... to configure default parsers.
  --default-separator DEFAULT_SEPARATOR
                        Default separator to use for command arguments.
  --long-prefix LONG_PREFIX
                        Default prefix for long flags.
  --output OUTPUT, -o OUTPUT
                        Output file to save the parsed command.

```

For the moment, argparse style isn't actually implemented, since no significant